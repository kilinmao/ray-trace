(()=>{"use strict";var e,t={879:()=>{},324:(e,t,n)=>{globalThis.ImageData;class a{constructor(e,t=512,n=512){e.style.justifyContent="center",e.style.alignItems="center",this.Canvas=document.createElement("canvas"),this.Canvas.style.width="100%",this.Canvas.style.height="100%",this.Canvas.width=t,this.Canvas.height=n,e.appendChild(this.Canvas)}clearCanvas(){let e=this.Canvas.getContext("2d");null!=e&&e.clearRect(0,0,this.Canvas.width,this.Canvas.height)}changeDimensions(e,t){this.Canvas.width=e,this.Canvas.height=t}savePNG(e="img.png"){this.Canvas.toBlob((function(t){var n=document.createElement("a");n.href=window.URL.createObjectURL(t),n.download=e,n.click()}),"./")}setImageData(e,t=0,n=0){let a=this.Canvas.getContext("2d");null!=a&&a.putImageData(e,t,n)}setPixel(e,t,n,a=1){let i=this.Canvas.getContext("2d");if(null!=i){let s=i.createImageData(1,1);s.data[0]=255*n.r,s.data[1]=255*n.g,s.data[2]=255*n.b,s.data[3]=255*a,i.putImageData(s,e,t)}}}function i(e,t){return e.id=t,e.style.gridArea=t,e.classList.add("window"),e.style.position="relative",e.style.display="flex",e.style.flexDirection="column",e.setLayout=function(t){e.style.display="grid",this.style.gridTemplateAreas='"'+t.map((e=>e.join(" "))).join('" "')+'"'},e.setLayoutRows=function(e){this.style.gridTemplateRows=e.join(" ")},e.setLayoutColumns=function(e){this.style.gridTemplateColumns=e.join(" ")},e}function s(e){return i(document.createElement("div"),e)}const o=i(document.body,"app");var r=n(477),l=n(365),d=n(466),c=n.n(d);class h{constructor(e,t,n,a,i){this.Parent=e,this.Renderer=t,this.Camera=n,this.Scene=a,this.Stats=new(c()),this.Controls=i,this.Stats.dom.style.position="absolute",this.Parent.appendChild(this.Stats.dom),this.Renderer.setPixelRatio(window.devicePixelRatio),this.Renderer.setSize(this.Parent.offsetWidth,this.Parent.offsetHeight),this.Renderer.autoClear=!1,this.Camera instanceof r.cPb&&(this.Camera.aspect=this.Parent.offsetWidth/this.Parent.offsetHeight),this.Camera.updateProjectionMatrix(),window.addEventListener("resize",(()=>{this.Renderer.setSize(this.Parent.offsetWidth,this.Parent.offsetHeight),this.Camera instanceof r.cPb&&(this.Camera.aspect=this.Parent.offsetWidth/this.Parent.offsetHeight),this.Camera.updateProjectionMatrix()})),this.Parent.appendChild(this.Renderer.domElement)}update(){this.Stats.update(),null!=this.Controls&&this.Controls.update()}preRenderHook(){}render(){this.Renderer.render(this.Scene,this.Camera)}animate(){requestAnimationFrame(this.animate.bind(this)),this.update(),this.preRenderHook(),this.render()}}class m{constructor(){return this._handler=[],new Proxy(this,{set:function(e,t,n){return e[t]=n,null!=e._handler&&e._handler.forEach((e=>e({key:t,value:n}))),!0}})}addCallback(e){this._handler.push(e)}}var p=n(376);let u;const f=new r.xsS,v=new r.cPb,w=new r.iMs(v.position);let g,C,y,x=2,b=2,P=0;const R=16;class j extends m{constructor(){super(...arguments),this.maxDepth=2,this.subsamples=1,this.width=256,this.height=256,this.correctSpheres=!1,this.phong=!1,this.alllights=!1,this.shadows=!1,this.mirrors=!1,this.render=function(){},this.saveImg=function(){}}}let M=512,S=512;function k(e,t,n,a){const i=e.intensity,s=e.position.clone().sub(a.clone());s.normalize();let o=1/s.lengthSq();const l=e.color.clone().multiplyScalar(i*o);let d=new r.Ilk;n.material instanceof r.xoR&&d.copy(n.material.color).multiply(l).multiplyScalar(Math.max(t.clone().dot(s),0));let c=d;if(n.material instanceof r.xoR){const i=v.position.clone().sub(a).normalize(),l=s.clone().add(i).normalize(),d=Math.max(t.dot(l),0),h=Math.max(t.dot(s),0)*e.intensity,m=Math.max(Math.pow(d,n.material.shininess),0)*h;let p=new r.Ilk;p.copy(n.material.specular);const u=Math.pow(Math.max(1-s.dot(l),0),5),f=n.material.shininess/6;let w=new r.Ilk(1,1,1);p=p.add(w.sub(p).multiplyScalar(u)),p.multiply(e.color),p.multiplyScalar(m*o*f),c.add(p)}return c}function O(){const{startX:e,startY:t}=function(){const e=P*R%S,t=Math.floor(P*R/S)*R;return P++,{startX:e,startY:t}}();for(let n=e;n<e+R&&n<S;n++)for(let e=t;e<t+R&&e<M;e++){const t=new r.Ilk(0,0,0),a=Math.pow(2,b);for(let i=0;i<b;i++)for(let s=0;s<b;s++){const o=i*b+s,l=n-1+o/a*2,d=e-1+o/a*2,c=new r.FM8(l/S*2-1,-d/M*2+1);w.setFromCamera(c,v);for(const e of g){const n=D(w,x,f.children,e);t.add(n)}}t.multiplyScalar(1/a),u.setPixel(n,e,t)}(e+R<S||t+R<M)&&requestAnimationFrame(O)}function D(e,t,n,a){var i,s,o;const l=new r.Ilk(0,0,0);if(C=e.intersectObjects(n,!1),(null===(i=C[0])||void 0===i?void 0:i.object)instanceof r.Kj0){const e=C[0].object;if(y=null===(o=null===(s=C[0].face)||void 0===s?void 0:s.normal)||void 0===o?void 0:o.transformDirection(e.matrixWorld),y instanceof r.Pa4){const i=v.position.clone().sub(C[0].point).normalize(),{reflectivity:s,mirror:o}=e.material,d=k(a,y,e,C[0].point);if(o&&t>0){const e=i.reflect(y).negate(),o=new r.iMs(C[0].point,e);l.add(d);const c=D(o,t-1,n,a);return l.lerp(c,s),l}if(!new r.iMs(C[0].point,a.position.clone().sub(C[0].point).normalize()).intersectObjects(n)[0]){let t=k(a,y,e,C[0].point);l.add(t)}}}return l}!function(){const e=(t="Basic",document.title=t,o);var t;e.setLayout([["renderer1","renderer2"],[".","."]]),e.setLayoutColumns(["1fr","1fr"]),e.setLayoutRows(["100%","0%"]),function(e){const t=new p.XS;return t.add(e,"width").name("Width").onChange((e=>{S=e,u.changeDimensions(S,M)})),t.add(e,"height").name("Height").onChange((e=>{M=e,u.changeDimensions(S,M)})),t.add(e,"correctSpheres").name("Correct Spheres").onChange((e=>{})),t.add(e,"phong").name("Phong").onChange((e=>{})),t.add(e,"alllights").name("All Lights").onChange((e=>{})),t.add(e,"shadows").name("Shadows").onChange((e=>{})),t.add(e,"mirrors").name("Mirrors").onChange((e=>{})),t.add(e,"maxDepth",0,10,1).name("Max Recursions").onChange((e=>{x=e})),t.add(e,"subsamples",1,4,1).name("Subsamples").onChange((e=>{b=e})),t.add(e,"render").name("Render").onChange((()=>{P=0,u.clearCanvas(),requestAnimationFrame(O)})),t.add(e,"saveImg").name("Save").onChange((()=>{u.savePNG()})),t}(new j).open();const n=s("renderer1"),i=s("renderer2");e.appendChild(n),e.appendChild(i);const d=new r.CP7({antialias:!0});!function(e){var t=new r.xoR({color:16711680,specular:11184810,shininess:150,reflectivity:0});t.mirror=!1;var n=new r.xoR({color:65280,specular:11184810,shininess:150,reflectivity:0});n.mirror=!1;var a=new r.xoR({color:255,specular:11184810,shininess:150,reflectivity:0});a.mirror=!1;var i=new r.xoR({color:16777215,specular:1118481,shininess:100,reflectivity:0});i.mirror=!1;var s=new r.xoR({color:6710886,specular:1118481,shininess:100,reflectivity:0});s.mirror=!1;var o=new r.xoR({color:16755200,specular:16777215,shininess:1e4,reflectivity:.8});o.mirror=!0;var l=new r.xo$(50/300,200,200),d=new r._12(602/300,602/300),c=new r.DvJ(100/300,100/300,100/300),h=new r.Kj0(l,t);h.position.set(-50/300,-250/300+5/300,-50/300),e.add(h),h.name="sphere";var m=new r.Kj0(l,n);m.position.set(175/300,-250/300+5/300,-.5),e.add(m),m.name="sphere2";var p=new r.Kj0(l,a);p.position.set(.25,-250/300+5/300,-.25),p.rotation.y=.5,e.add(p),p.name="sphere3";var u=new r.Kj0(c,o);u.position.set(-175/300,-250/300+2.5/300,-.5),u.rotation.y=.25,e.add(u),u.name="box";var f=new r.Kj0(d,s);f.position.set(0,-1,-.5),f.rotation.x=-1.57,f.scale.setY(.6),e.add(f),f.name="planebottom";var v=new r.Kj0(d,i);v.position.set(0,1,-.5),v.rotation.x=1.57,v.scale.setY(.6),e.add(v),v.name="planetop";var w=new r.Kj0(d,o);w.position.set(0,0,-1),e.add(w),w.name="planeback";var g=new r.Kj0(d,t);g.rotation.z=1.57,g.rotation.y=1.57,g.position.set(-1,0,-.5),g.scale.setY(.6),e.add(g),g.name="planeleft";var C=new r.Kj0(d,a);C.rotation.z=1.57,C.rotation.y=-1.57,C.position.set(1,0,-.5),C.scale.setY(.6),e.add(C),C.name="planeright",e.updateMatrixWorld()}(f),g=function(e){var t=.25,n=[],a=new r.cek(16777215,.5);a.position.set(0,0,1),e.add(a),n.push(a),a.updateMatrixWorld(),a.name="light1";var i=new r.cek(16755285,t);i.position.set(-200/300,100/300,100/300),e.add(i),n.push(i),i.updateMatrixWorld(),i.name="light2";var s=new r.cek(5614335,t);return s.position.set(200/300,100/300,100/300),e.add(s),n.push(s),s.updateMatrixWorld(),s.name="light3",n}(f),function(e){e.fov=60,e.far=1e3,e.near=.001,e.position.z=1.8,e.updateProjectionMatrix(),e.updateMatrixWorld()}(v);const c=new l.z(v,i);!function(e){e.rotateSpeed=1,e.zoomSpeed=1.2,e.enableZoom=!0,e.keys={LEFT:"65",UP:"87",RIGHT:"68",BOTTOM:"83"},e.minDistance=1e-5,e.maxDistance=9,e.minZoom=0}(c);const m=new h(i,d,v,f,c);u=new a(n),u.changeDimensions(M,S),m.animate()}()}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e].call(s.exports,s,s.exports,a),s.exports}a.m=t,e=[],a.O=(t,n,i,s)=>{if(!n){var o=1/0;for(c=0;c<e.length;c++){for(var[n,i,s]=e[c],r=!0,l=0;l<n.length;l++)(!1&s||o>=s)&&Object.keys(a.O).every((e=>a.O[e](n[l])))?n.splice(l--,1):(r=!1,s<o&&(o=s));if(r){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,i,s]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var i,s,[o,r,l]=n,d=0;if(o.some((t=>0!==e[t]))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(l)var c=l(a)}for(t&&t(n);d<o.length;d++)s=o[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},n=self.webpackChunkray_tracing=self.webpackChunkray_tracing||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.O(void 0,[345],(()=>a(324)));var i=a.O(void 0,[345],(()=>a(879)));i=a.O(i)})();